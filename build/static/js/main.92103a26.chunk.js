(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{130:function(e,t,a){e.exports=a(321)},135:function(e,t,a){},320:function(e,t,a){},321:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(33),s=a.n(r),l=(a(135),a(10)),c=a(11),o=a(16),u=a(15),h=a(17),d=a(3),p=["R","G","B","Y"],m=[0,1,2,3,4,5,6,7,8,9,"Skip"];function v(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=[];return p.forEach(function(e){m.forEach(function(a){t.push(e+":"+a)})}),[].forEach(function(e){t.push("E:"+e)}),e&&function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}}(t),t}function y(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),a=/^#?([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:16*parseInt(a[1],16),g:16*parseInt(a[2],16),b:16*parseInt(a[3],16)}}function f(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,r=y(e),s=y(t),l=function(e,t,a,n,i){return(e-t)/(a-t)*(i-n)+n}(a,n,i,0,1);l=Math.pow(l,1/8);var c=s.r-r.r,o=s.g-r.g,u=s.b-r.b;return c=c*l+r.r,o=o*l+r.g,u=u*l+r.b,"rgb("+Math.round(c)+", "+Math.round(o)+", "+Math.round(u)+")"}function g(e,t){var a=e.split(":"),n=a[0],i=a[1];return t.filter(function(e){var t=(a=e.split(":"))[0],r=a[1];return"E"===t||(t===n||r===i)})}Array.prototype.remove=function(){for(var e,t,a=arguments,n=a.length;n&&this.length;)for(e=a[--n];-1!==(t=this.indexOf(e));)this.splice(t,1);return this};var b=a(129),k=a(71),E=a(51),O=a.n(E),j=a(126),N=a.n(j),w=a(127),A=a.n(w),C=a(128),P=a.n(C);O.a.use(N.a),O.a.use(A.a);var x={};console.log=function(){};var M=function(){function e(t,a,n,i){Object(l.a)(this,e),this.playArea=t.slice(),this.deck=a.slice(),this.playerHands=n.slice(),this.turn=i,this.numPlayers=this.playerHands.length,this.card=this.playArea[this.playArea.length-1]}return Object(c.a)(e,[{key:"equals",value:function(e){return e.turn===this.turn&&JSON.stringify(e.playArea)===JSON.stringify(this.playArea)&&JSON.stringify(e.deck)===JSON.stringify(this.deck)&&JSON.stringify(e.playerHands)===JSON.stringify(this.playerHands)}},{key:"copy",value:function(){return new e(this.playArea,this.deck,this.playerHands,this.turn)}}]),e}(),H=function(){function e(t,a,n,i,r,s){Object(l.a)(this,e),this.children={},this.bestCard=null,this.card=r,this.type=a,this.prob=1,this.id=t,this.state=n,this.player=i,this.parent=s,this.pruned=!1,this.prune=!s||s.prune,this.state.turn===this.player?this.type="max":this.type="min",console.log(n,this.state),this.curHand=this.state.playerHands[this.state.turn],"min"===this.type?this.value=Number.MAX_VALUE:"max"===this.type?this.value=-Number.MAX_VALUE:"chance"===this.type&&(this.value=0),console.log("Created Node",this)}return Object(c.a)(e,[{key:"getLabel",value:function(){var e="";return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(e=" "+this.count_children()),this.pruned?"P"+this.state.turn+" : pruned":"P"+this.state.turn+" : "+Math.round(1e3*this.value)/1e3+e}},{key:"setProb",value:function(e){this.prob=e}},{key:"addChild",value:function(e,t){this.children[e]=t}},{key:"count_children",value:function(){for(var e=0,t=0,a=Object.values(this.children);t<a.length;t++){e+=1+a[t].count_children()}return e}},{key:"get_root",value:function(){return null===this.parent?this:this.parent.get_root()}},{key:"updateValue",value:function(e){var t=null;return"min"===this.type?this.value>e.value&&(t=e.card,this.value=e.value):"max"===this.type?this.value<=e.value&&(t=e.card,this.value=e.value):"chance"===this.type&&(this.value+=e.value*e.prob),t}},{key:"find",value:function(e){if(this.id===e)return this;for(var t=0,a=Object.entries(this.children);t<a.length;t++){var n=a[t],i=Object(k.a)(n,2),r=(i[0],i[1].find(e));if(null!==r)return r}return null}},{key:"findBest",value:function(t){var a=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-Number.MAX_VALUE,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_VALUE;if(0!==this.curHand.length){if(this.id.split("_").length>200)return this.value=-3,void console.log("Truncated");var r=t[0],s=(this.state.turn+1)%this.state.numPlayers;try{if(0===t.length){console.log("Drawing card for ",this,this.state.deck);var l=this.curHand.slice(),c=this.state.deck.slice(),o=this.state.playArea.slice();if(0===c.length)return void(this.value=0);var u=c.splice(0,1);l.push(u[0]);var h=this.state.playerHands.slice();h[this.state.turn]=l;var d=new e(this.id+"_"+u,"max",new M(o,c,h,s),this.player,u[0],this);console.log("checking compat",this,s,h);var p=g(this.state.card,h[s]);if(console.log("Finding the best for1 ",d,p),this.pruned)d.value="NA",d.pruned=!0;else{d.findBest(p,n,i);var m=this.updateValue(d);null!==m&&(r=m),"min"===this.type?n=Math.max(n,this.value):"max"===this.type&&(i=Math.min(i,this.value))}console.log("Adding child ",d),this.addChild(u,d),n>=i&&this.prune&&(this.pruned=!0)}else console.log("Arr ",this,t),Array.isArray(t)&&t.forEach(function(t){var l=a.curHand.slice().remove(t);if(0!==l.length){var c=a.state.playerHands.slice();c[a.state.turn]=l;var o=a.state.playArea.slice();o.push(t),"Skip"===t.split(":")[1]&&(s=(s+1)%a.state.numPlayers);var u=new e(a.id+"_"+t,"max",new M(o,a.state.deck,c,s),a.player,t,a),h=g(t,c[s]);if(console.log("Finding the best for ",u,h),a.pruned)u.value="NA",u.pruned=!0;else{u.findBest(h,n,i);var d=a.updateValue(u);null!==d&&(r=d),"min"===a.type?n=Math.max(n,a.value):"max"===a.type&&(i=Math.min(i,a.value))}console.log("Adding child ",u),a.addChild(t,u),n>=i&&a.prune&&(a.pruned=!0)}else a.player===a.state.turn?a.value=1:a.value=-10})}catch(v){if(console.log("Cutoff",v),this.pruned=!0,v!==x)throw v}return this.pruned=!1,this.alpha=n,this.beta=i,console.log("AB",n,i,this.id),r}this.value=1}},{key:"serialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"nested",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=[],n="#ccc";if("linear"===e){var i="ellipse";"max"===this.type?i="triangle":"min"===this.type&&(i="vee");var r="#666";this.pruned&&(r="#B71C1C"),a.push({data:{id:this.id,label:this.getLabel(t>=10),type:i,color:r},position:{x:100,y:100}})}for(var s=0,l=Object.entries(this.children);s<l.length;s++){var c=l[s],o=Object(k.a)(c,2),u=o[0],h=o[1];"linear"===e?t<10&&(a=a.concat(h.serialize(e,t+1)),this.value===h.value?n="#1B5E20":(n=f("#B71C1C","#1B5E20",0),console.log(n,h.prob)),a.push({data:{source:this.id,target:h.id,label:u,color:n}}),a=Object(b.a)(new Set(a))):"nested"===e&&a.push({name:u,children:h.serialize(e,t+1)})}return console.log("Result",this.id,a),a}}]),e}();var _=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={width:0,height:0,root:{}},a.reset=a.reset.bind(Object(d.a)(Object(d.a)(a))),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.updateWindowDimensions()}},{key:"updateWindowDimensions",value:function(){var e=s.a.findDOMNode(this).getBoundingClientRect();this.setState({width:e.width,height:window.innerHeight-e.y-120})}},{key:"reset",value:function(){this.props.updateNode(this.props.data.get_root())}},{key:"render",value:function(){var e=this,t={name:"Start",children:[]};t=[],console.log("T"),0!==Object.keys(this.props.data).length&&(t=this.props.data.serialize("linear")),console.log(this.cy);var a=this;void 0!==this.cy&&this.cy.on("click","node",function(e){console.log("clicked "+this.id());var t=a.props.data.find(this.id());console.debug(t,a.props.data),a.props.updateNode(t)}),setTimeout(function(){a.cy.layout({name:"dagre"}).run(),console.log("done")},100),console.log("DATA",t);var n=0;return this.props.data instanceof H&&(n=this.props.data.count_children()),i.a.createElement("div",{style:{height:"100%"}},i.a.createElement("h2",null,"MiniMax : ",n," \xa0\xa0\xa0",i.a.createElement("button",{className:"btn btn-info",onClick:this.reset},"Reset Graph")),i.a.createElement(P.a,{elements:t,style:{width:this.state.width+"px",height:this.state.height+"px"},layout:{name:"random"},cy:function(t){return e.cy=t},stylesheet:[{selector:"edge",style:{"line-color":"data(color)",label:"data(label)"}},{selector:"node",style:{"background-color":"data(color)",shape:"data(type)",label:"data(label)"}}]}))}}]),t}(i.a.Component),S=(a(320),function(e){function t(e){var a;Object(l.a)(this,t),a=Object(o.a)(this,Object(u.a)(t).call(this,e));for(var n=[],i=0;i<=2;i++)n.push([]);return a.state={numPlayers:3,cardsPerPlayer:4,deck:[],playerHands:n,turn:0,playArea:[],minimax:{}},a.play=a.play.bind(Object(d.a)(Object(d.a)(a))),a.autoPlay=a.autoPlay.bind(Object(d.a)(Object(d.a)(a))),a.updateMinimax=a.updateMinimax.bind(Object(d.a)(Object(d.a)(a))),a.init=a.init.bind(Object(d.a)(Object(d.a)(a))),a.handleChange=a.handleChange.bind(Object(d.a)(Object(d.a)(a))),a.checkEnded=a.checkEnded.bind(Object(d.a)(Object(d.a)(a))),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"init",value:function(){var e=v(),t=[],a=this.state.numPlayers,n=this.state.cardsPerPlayer;this.setState({deck:e},function(){for(var i=0;i<=a-1;i++)t.push(this.getCards(n));var r=this.getCards();this.setState({numPlayers:a,cardsPerPlayer:n,deck:e,playerHands:t,turn:0,playArea:r,minimax:{}})})}},{key:"componentDidMount",value:function(){}},{key:"handleChange",value:function(e){console.debug(e,e.target.name);var t={};t[e.target.name]=+e.target.value,this.setState(t)}},{key:"getCards",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.state.deck.splice(0,e)}},{key:"autoPlay",value:function(){setInterval(this.play,1e3)}},{key:"updateMinimax",value:function(e){this.setState({minimax:e})}},{key:"checkEnded",value:function(){return console.debug(this.state.playerHands),void 0===this.state.playerHands||this.state.playerHands.map(function(e){return 0===e.length}).reduce(function(e,t){return e||t},!1)}},{key:"play",value:function(){console.log("Playing");var e=this.state.playArea[this.state.playArea.length-1],t=(this.state.turn+1)%this.state.numPlayers,a=this.state.playerHands,n=this.state.playerHands[this.state.turn],i=this.state.playArea,r=g(e,n);if(console.log(r,n),0===r.length){var s=this.getCards();n=n.concat(s)}else{var l=function(e,t,a,n,i,r){var s=new M(t,a,n,i);console.log(s);var l=new H("root","max",s,i,null,null);console.debug("Node",l,l.count_children()),console.time("someFunction");var c=l.findBest(e);return console.timeEnd("someFunction"),console.debug("Node",l,l.count_children()),r(l),c}(r,this.state.playArea,this.state.deck,this.state.playerHands,this.state.turn,this.updateMinimax);n.remove(l),i.push(l),"E"===l.split(":")[0]&&i.push("R:C")}a[this.state.turn]=n,console.log(a,n),this.setState({turn:t,playerHands:a,playArea:i})}},{key:"render",value:function(){var e=[],t=this.checkEnded();console.debug(t);for(var a=0;a<this.state.numPlayers;a++)e.push(i.a.createElement(I,{key:a,hand:this.state.playerHands[a],turn:this.state.turn===a,num:a}));return i.a.createElement("div",null,i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("h2",null,"Uno Board")),i.a.createElement("div",{className:"col"},i.a.createElement("button",{className:"btn-success btn",disabled:t,onClick:this.play},"Play"),i.a.createElement("button",{className:"btn-warning btn",disabled:t,onClick:this.autoPlay},"Auto Play")),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-2"},i.a.createElement("button",{className:"btn-danger btn",onClick:this.init},"Init")),i.a.createElement("div",{className:"col-md-3"},i.a.createElement("div",{className:"form-group form-inline"},i.a.createElement("label",null,"cards ",i.a.createElement("input",{type:"text",defaultValue:this.state.cardsPerPlayer,style:{width:"40px"},name:"cardsPerPlayer",className:"form-control",onChange:this.handleChange})))),i.a.createElement("div",{className:"col-md-2"},i.a.createElement("div",{className:"form-group form-inline"},i.a.createElement("label",null,"players ",i.a.createElement("input",{type:"text",defaultValue:this.state.numPlayers,style:{width:"40px"},name:"numPlayers",className:"form-control",onChange:this.handleChange}))))))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement(B,{cards:this.state.deck})),i.a.createElement("div",{className:"col"},i.a.createElement(D,{cards:this.state.playArea}))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-3"},e),i.a.createElement("div",{className:"col-md-9"},i.a.createElement(_,{data:this.state.minimax,updateNode:this.updateMinimax}))))}}]),t}(i.a.Component)),B=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.cards.map(function(e){return i.a.createElement(V,{card:e,key:e})});return i.a.createElement("div",null,i.a.createElement("h2",null,"Deck"),e)}}]),t}(i.a.Component),D=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.cards.map(function(e){return console.log("PCARD",e),i.a.createElement(V,{card:e,key:e})});return i.a.createElement("div",null,i.a.createElement("h2",null,"Play Area"),e)}}]),t}(i.a.Component),I=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.hand.map(function(e){return i.a.createElement(V,{card:e,key:e})}),t="";return this.props.turn&&(t="active"),i.a.createElement("div",null,i.a.createElement("h2",{className:t},"Player ",this.props.num),e)}}]),t}(i.a.Component),V=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="unoCard ",t=this.props.card.split(":"),a=t[0],n=t[1];return e+=a+" ",e+=n+" ",i.a.createElement("div",{className:e},n)}}]),t}(i.a.Component),J=S;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(J,null),document.getElementById("react_main")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[130,1,2]]]);
//# sourceMappingURL=main.92103a26.chunk.js.map